improve_detroit:
  slug: improve_detroit
  name: Improve Detroit
  category: Improve Detroit
  source:
    type: socrata
    url: j7tb-epek
    params:
      $select: location, address, ticket_closed_date_time, ticket_created_date_time, ticket_status, issue_type
      $limit: 10000
      $order: ticket_created_date_time desc
  layers:
    - name: Tree Issue
      type: symbol
      filter: ["==", "issue_type", "Tree Issue"]
      layout:
        visibility: none
        icon-image: improve-tree
        icon-size:
          stops:
            - [9, 0.5]
            - [15, 1]
            - [19, 1.75]
        icon-allow-overlap: true
      paint:
        icon-opacity:
          stops:
            - [9, 0.2]
            - [19, 1]
      legend:
        image: './img/improve-tree.svg'
    - name: Blocked Catch Basin
      type: symbol
      filter: ["==", "issue_type", "Blocked Catch Basin"]
      layout:
        visibility: none
        icon-image: improve-catchbasin
        icon-size:
          stops:
            - [9, 0.5]
            - [15, 1]
            - [19, 1.75]
        icon-allow-overlap: true
      paint:
        icon-opacity:
          stops:
            - [9, 0.2]
            - [19, 1]
      legend:
        image: './img/improve-catchbasin.svg'
    - name: Illegal Dumping
      type: symbol
      filter: ["in", "issue_type", "Illegal Dumping", "Illegal Dump Sites"]
      layout:
        visibility: none
        icon-image: improve-dumping
        icon-size:
          stops:
            - [9, 0.5]
            - [15, 1]
            - [19, 1.75]
        icon-allow-overlap: true
      paint:
        icon-opacity:
          stops:
            - [9, 0.2]
            - [19, 1]
      legend:
        image: './img/improve-dumping.svg'  
  popup:
    title: Improve Detroit Issue
    columns:
      - field: address
        type: text
        name: Address
      - field: issue_type
        type: text
        name: Issue Type
      - field: ticket_created_date_time
        type: date
        name: Ticket Open Time
      - field: ticket_closed_date_time
        type: date
        name: Ticket Close Time
greenlight:
  slug: greenlight
  name: Project Greenlight
  category: Greenlight
  source:
    type: esri
    url: https://services2.arcgis.com/qvkbeam7Wirps6zC/ArcGIS/rest/services/ProjectGreenlight/FeatureServer/0
    params:
      outFields: '*'
      outSR: 4326
      where: 1=1
      f: geojson
  layers:
    - name: Active Location
      type: symbol
      filter: ["==", "Status", "Green"]
      layout:
        visibility: none
        icon-image: greenlight-active
        icon-size:
          stops:
            - [9, 0.5]
            - [15, 1]
            - [19, 1.75]
        icon-allow-overlap: true
      paint:
        icon-opacity:
          stops:
            - [9, 0.2]
            - [19, 1]
      legend:
        image: './img/greenlight-active.svg'
  popup:
    title: Greenlight Location
    columns:
      - field: Address
        type: text
        name: Address
      - field: Corporate_Entity
        type: text
        name: Business Name
permits:
  slug: permits
  name: Building Permits
  category: Housing
  source:
    type: socrata
    url: but4-ky7y
    params:
      $select: permit_issued, site_location, residential, site_address, estimated_cost, bld_permit_desc, bld_permit_type
      $where: bld_permit_type in ('New', 'Alterations') and date_trunc_y(permit_issued) = '2017-01-01'
      $limit: 100000
  layers:
    - name: Residential Permits
      type: circle
      filter: ["==", "residential", "RESIDENTIAL"]
      layout:
        visibility: none
      paint:
        circle-color: orange
        circle-radius:
          stops:
            - [9, 0]
            - [9.1, .5]
            - [14, 3]
            - [16, 6]
            - [19, 10]
        circle-opacity:
          stops:
            - [9, 0]
            - [9.1, 0.25]
            - [14, 0.55]
            - [20, 0.75]
      legend:
        style:
          - "border-radius: 50%;"
          - "width: 15px;"
          - "height: 15px;"
          - "background: orange;"
    - name: Commercial Permits
      type: circle
      filter: ["==", "residential", "NON-RESIDENTIAL"]
      layout:
        visibility: none
      paint:
        circle-color: purple
        circle-radius:
          stops:
            - [9, 0]
            - [9.1, .5]
            - [14, 3]
            - [16, 6]
            - [19, 10]
        circle-opacity:
          stops:
            - [9, 0]
            - [9.1, 0.25]
            - [14, 0.55]
            - [20, 0.75]
      legend:
        style:
          - "border-radius: 50%;"
          - "width: 15px;"
          - "height: 15px;"
          - "background: purple;"
  popup:
    title: Building Permit
    columns:
    - field: site_address
      name: Address
      type: text
    - field: bld_permit_type
      name: Permit Type
      type: text  
    - field: bld_permit_desc
      name: Description
      type: text
    - field: estimated_cost
      name: Cost
      type: money
    - field: permit_issued
      name: Date of Issue
      type: date
sales: 
  slug: sales
  name: Recent Sales
  category: Housing
  source:
    type: socrata
    url: 9xku-658c
    params:
      $select: location, address, grantee, grantor, sale_date, sale_price, terms
      $where: >
       terms = 'VALID ARMS LENGTH' 
       and sale_price > 10000 
       and date_trunc_y(sale_date) = '2017-01-01T00:00:00.000'
  layers:
    - name: Property Sale
      type: symbol
      layout:
        visibility: none
        icon-image: sale-cash
        icon-size:
          stops:
            - [9, 0.5]
            - [15, 0.8]
            - [19, 1.25]
        icon-allow-overlap: true
      paint:
        icon-opacity:
          stops:
            - [9, 0.2]
            - [19, 1]
      legend:
        image: './img/sale-cash.svg'
  popup:
    title: Property Sale
    columns:
      - field: address
        type: text
        name: Address
      - field: grantee
        type: text
        name: Sold to
      - field: grantor
        type: text
        name: Sold by
      - field: sale_date
        type: date
        name: Sale Date
      - field: sale_price
        type: money
        name: Sale Price
      - field: terms
        type: text
        name: Sale Terms

